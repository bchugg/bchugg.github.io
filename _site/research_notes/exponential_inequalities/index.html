<!DOCTYPE html>
<html lang="en-us">

  <head prefix="og: http://ogp.me/ns#; dc: http://purl.org/dc/terms/#">
  
  
  <!-- Canonical link to help search engines -->
  <link rel="canonical" href="http://localhost:4000/research_notes/exponential_inequalities/" />

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PN2H9928PZ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-PN2H9928PZ');
  </script>

  <!-- Basic meta elements -->
  <meta charset="utf-8" />

  <!-- Enable responsiveness on mobile devices -->
  <meta name="viewport" content="width=device-width,initial-scale=1.0,shrink-to-fit=no" />

  <!-- Mathjax Support -->
  <script type="text/javascript" async
    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>

  <title>
    
     A Table of Exponential Inequalities
    
  </title>

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v3.9.1" />
<meta property="og:title" content="A Table of Exponential Inequalities" />
<meta name="author" content="Ben Chugg" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="A list of exponential inequalities that underlie useful concentration inequalities" />
<meta property="og:description" content="A list of exponential inequalities that underlie useful concentration inequalities" />
<link rel="canonical" href="http://localhost:4000/research_notes/exponential_inequalities/" />
<meta property="og:url" content="http://localhost:4000/research_notes/exponential_inequalities/" />
<meta property="og:site_name" content="benny" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-08-23T00:00:00+02:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="A Table of Exponential Inequalities" />
<meta name="twitter:site" content="@bennychugg" />
<meta name="twitter:creator" content="@Ben Chugg" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Ben Chugg","url":"https://benchugg.com"},"dateModified":"2023-08-23T00:00:00+02:00","datePublished":"2023-08-23T00:00:00+02:00","description":"A list of exponential inequalities that underlie useful concentration inequalities","headline":"A Table of Exponential Inequalities","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/research_notes/exponential_inequalities/"},"url":"http://localhost:4000/research_notes/exponential_inequalities/"}</script>
<!-- End Jekyll SEO tag -->


  <!-- Dublin Core metadata for Zotero -->
  <meta property="dc:title" content="A Table of Exponential Inequalities" />
  <meta property="dc:creator" content="Ben Chugg" />
  <meta property="dc:identifier" content="http://localhost:4000/research_notes/exponential_inequalities/" />
  
  <meta property="dc:date" content="2023-08-23 00:00:00 +0200" />
  
  <meta property="dc:source" content="benny" />

  <!-- Open Graph and Twitter metadata -->
  <meta property="og:title" content="A Table of Exponential Inequalities" />
  <meta property="og:url" content="http://localhost:4000/research_notes/exponential_inequalities/" />
  
    <meta property="og:image" content="http://localhost:4000/assets/images/heads.jpeg"/>
    <meta name="twitter:image" content="http://localhost:4000/assets/images/heads.jpeg" />
  
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  <meta name="twitter:card" content="summary">
  <meta name="twitter:domain" value="benchugg.com" />
  <meta name="twitter:title" value="A Table of Exponential Inequalities" />
  <meta name="twitter:url" value="http://localhost:4000" />
  
  <!-- Description is dependent on page type  -->
  
    <meta property="og:description" content="A list of exponential inequalities that underlie useful concentration inequalities">
    <meta name="twitter:description" value="A list of exponential inequalities that underlie useful concentration inequalities" />
    <meta property="og:type" content="article" />
  
  

  <!-- CSS link -->
  <link rel="stylesheet" href="/assets/css/style.css" />

  <!-- Icons -->
  <link rel="apple-touch-icon" sizes="167x167" href="/assets/favicon.ico" />
  <link rel="apple-touch-icon-precomposed" sizes="180x180" href="/assets/favicon.ico" />
  <link rel="apple-touch-icon-precomposed" sizes="152x152" href="/assets/favicon.ico">
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/assets/favicon.ico">
  <link rel="apple-touch-icon-precomposed" href="/assets/favicon.ico">
  <link rel="shortcut icon" href="/assets/favicon.ico" />
  <link rel=”apple-touch-icon” sizes="114×114" href="/assets/favicon.ico" />
  <link rel=”apple-touch-icon” sizes="72×72" href="/assets/favicon.ico" />
  <link rel=”apple-touch-icon” href="/assets/favicon.ico" />
  <link rel=”icon” href="/assets/favicon.ico", sizes="32x32"/>

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="http://localhost:4000/atom.xml" />

  
</head>


  <body class="theme-base-">


    <!--
      Wrap is the content to shift when toggling the sidebar. We wrap the content to avoid any CSS
      collisions with our real content.
    -->
    <div class="wrap">
      <header class="masthead">
        <div class="container">
          <a id='name' href="/">Ben Chugg</a>
          <div class="span">
            <a href="/papers/">Papers</a> 
            <a href="/writing/">Writing</a>
            <a href="/research_notes/">Notes</a>
          </div>
        </div>
      </header>

      <main class="container content" id="main">
        <article class="note">
  <!-- <small>
    <a id="back", href="/research_notes/">Back to all notes</a>
  </small> -->
  <!-- <hr> -->
  
  <p class='title'>A Table of Exponential Inequalities</p> 
  <p id="date">August 23, 2023</p>
  <br/>
  \[\newcommand{\Pr}{\mathbb{P}}
\newcommand{\E}{\mathbb{E}}
\newcommand{\Re}{\mathbb{R}}
\newcommand{\Xbar}{\overline{X}}
\newcommand{\Var}{\mathbb{V}}\]

<p>I forget useful exponential inequalities all the time and I’m sick of looking them up. (Pf) stands for proof and will jump you to the proof of the given inequality. If I’ve omitted your favorite inequality let me know.</p>

<p>I considered writing a big list of <em>concentration</em> inequalities, but then I realized that most of the time what I really wanted was the inequality underlying the concentration inequality, which is typically some sort of exponential inequality. So here we are. Plus, I do a lot of work with martingales, and writing things out like I’ve done here makes obvious the resulting supermartingale.</p>

<p>Are there papers that do this more formally and completely? Yes, e.g., <a rel="nofollow noopener noreferrer" href="https://arxiv.org/pdf/1808.03204.pdf">this one</a>. But I needed something for myself that was easy and interpretable.</p>

<p>Throughout, let \(X\) be a random variable with mean \(\mu\). Set \(\Xbar = X-\mu\).</p>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Condition</th>
      <th>Bound</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Hoeffding <a href="#proof-of-hoeffding">(Pf)</a></td>
      <td>\(X\in [a,b]\)</td>
      <td>\(\E\exp\{\lambda \Xbar - \frac{\lambda^2}{8}(b-a)^2\}\leq 1\)</td>
    </tr>
    <tr>
      <td>Self-bounding <a href="#proof-of-self-bounding">(Pf)</a></td>
      <td>MGF exists</td>
      <td>\(\forall \lambda\in\Re\quad \E \exp\{\lambda X - \log \E \exp(\lambda X)\}= 1\)</td>
    </tr>
    <tr>
      <td>Bennett <a href="#proof-of-bennett">(Pf)</a></td>
      <td>\(\vert X \vert \leq H\) \(\E[X^2]\leq v^2&lt;\infty\)</td>
      <td>\(\forall\lambda\in (0,\frac{1}{v})\quad \E\exp\{-\lambda\Xbar - \frac{\mu^2}{H^2}(e^{\lambda H} - \lambda H -1)\}\leq 1\)</td>
    </tr>
    <tr>
      <td>One-sided Bernstein I <a href="#proof-of-one-sided-bernstein-i">(Pf)</a></td>
      <td>\(X \leq H\) and \(\E[X^2]&lt;\infty\)</td>
      <td>\(\forall \vert\lambda \vert\leq \frac{1}{2H}\quad \E\exp\{\lambda \Xbar - (e-2)\lambda^2\Var(X)\}\leq 1\)</td>
    </tr>
    <tr>
      <td>One-sided Bernstein II <a href="#proof-of-one-sided-bernstein-ii">(Pf)</a></td>
      <td>\(X\geq 0\) and \(\E[X^2]&lt;\infty\)</td>
      <td>\(\forall \lambda&gt;0 \quad \E\exp\{-\lambda\Xbar - \lambda^2\E[X^2]/2\}\leq 1\)</td>
    </tr>
    <tr>
      <td>Delyon <a href="#proof-of-delyon">(Pf)</a></td>
      <td>\(\E[X^2] &lt; \infty\)</td>
      <td>\(\forall \lambda\in \Re\quad \E[\exp\{\lambda\Xbar - \frac{\lambda^2}{6}(\Xbar^2 - 2\E[\Xbar^2])\}]\leq 1\)</td>
    </tr>
    <tr>
      <td>Fan <a href="#proof-of-fan">(Pf)</a></td>
      <td>\(X\geq -1\), \(\E[X]\leq 0\)</td>
      <td>\(\forall \lambda\in[0,1)\quad \E\exp\{\lambda X + X^2(\log(1 - \lambda) + \lambda)\}\leq 1\)</td>
    </tr>
    <tr>
      <td>Catoni <a href="#proof-of-catoni">(Pf)</a></td>
      <td>\(\E[\vert X\vert^p]&lt;\infty, p&gt;1\)</td>
      <td>\(\forall\lambda&gt;0\quad \E\exp\{\phi_p(\lambda X) - \frac{\lambda^p}{p}\E[\vert X\vert^p]\} \leq 1\) where \(\phi_p(x) \leq \log(1 + x + \vert x\vert^p/p)\)</td>
    </tr>
  </tbody>
</table>

<h2 id="proof-of-hoeffding">Proof of Hoeffding</h2>

<p>Just note that a bounded random variable \(X\in[a,b]\) is \((b-a)/2\)-sub-Gaussian, and apply the definition of sub-Gaussianity. It can also be proved more directly, see <a rel="nofollow noopener noreferrer" href="https://en.wikipedia.org/wiki/Hoeffding%27s_lemma">wikipedia</a>.</p>

<h2 id="proof-of-self-bounding">Proof of Self-Bounding</h2>

<p>Clear by definition:</p>

\[\begin{align}
\E\exp\{\lambda X - \log \E \exp(\lambda X)\} &amp;= \E\exp\{\lambda X\}\exp\{-\log \E\exp\{\lambda X\}\} \\
&amp;= \E\exp\{\lambda X\}\exp\log(\E\exp\{\lambda X\})^{-1} = 1.
\end{align}\]

<h2 id="proof-of-bennett">Proof of Bennett</h2>

<p>Set \(\psi(x) = e^x - x -1\). Notice that the function \(\psi(x)/x^2\) is monotonically increasing. (Technically, at \(x=0\), one should continuously extend the function; the left and right limits are the same so this works out. Plot the function if you don’t believe me.) Since \(X\leq H\), we have</p>

\[\frac{1}{(\lambda X)^2}\psi(\lambda X) \leq \frac{1}{(\lambda H)^2}\psi(\lambda H).\]

<p>Rearranging,</p>

\[\begin{equation}
\label{eq:bennett-I}
e^{\lambda X} \leq \frac{X^2}{H^2}\psi(\lambda H) + \lambda X + 1, 
\end{equation}\]

<p>so</p>

\[\begin{equation}
\label{eq:bennett-ii}
\E e^{\lambda X} \leq \frac{\E X^2}{H^2}\psi(\lambda H) + \lambda \mu + 1. \tag{1}
\end{equation}\]

<p>Let \(v&gt;0\) be a bound on the second moment, i.e., \(\E[X^2]\leq v^2&lt;\infty\). Then \(\mu^2 \leq v^2\) so \(|\mu|\leq v\).<br />
Using the inequality \(e^x \geq 1 + x\) for all \(x\),  notice that \(\psi(x)\geq 0\), so 
\(\frac{\mu^2}{H^2}\psi(\lambda H) + \lambda\mu \geq \lambda\mu \geq -\lambda v&gt; -1\) if \(\lambda&lt; 1/v\).   Therefore, taking logs of both sides of \eqref{eq:bennett-ii} is well-defined. Deploying the inequality \(\log(1 +x )\leq x\) for \(x&gt;-1\), we have</p>

\[\log \E e^{\lambda X} \leq \log\bigg(\frac{v^2}{H^2}\psi(\lambda H) + \lambda\mu + 1\bigg) \leq \frac{v^2}{H^2}\psi(\lambda H) + \lambda\mu.\]

<p>Adding \(-\lambda \mu = -\log e^{\lambda \mu}\) to both sides, we obtain</p>

\[\log \E \frac{e^{\lambda X}}{e^{\lambda \mu}} \leq \frac{v^2}{H^2}\psi(\lambda H) + \lambda\mu - \log \E e^{\lambda X} \leq \frac{v^2}{H^2}\psi(\lambda H),\]

<p>which, after exponentiating and rearranging, is the desired inequality.</p>

<h2 id="proof-of-one-sided-bernstein-i">Proof of one-sided Bernstein I</h2>

<p>The inequality \(e^x \leq 1 + x + (e-2)x^2\) holds for all \(x\leq 1\). Applying this with \(x = \lambda\Xbar\) and taking expectations we obtain</p>

\[\begin{align}
\E[e^{\lambda \Xbar}] \leq 1 + \E[\lambda \Xbar] + (e-2)\lambda^2 \Var(X) = 1 + (e-2)\lambda^2 \Var(X) \leq \exp\{(e-2) \lambda^2\Var(X)\}.
\end{align}\]

<p>Rearranging gives the result. Note that we needed the condition on \(\lambda\) to ensure that \(\lambda \Xbar\leq 1\): \(\lambda\Xbar \leq \vert\lambda\vert \vert X-\mu\vert\leq \vert\lambda \vert 2H \leq 1\).</p>

<h2 id="proof-of-one-sided-bernstein-ii">Proof of one-sided Bernstein II</h2>

<p>Let \(Z=-X\) and put \(\psi(s)= e^s - s -1\). Set</p>

\[g(s) = \begin{cases}
    \psi(s)/s^2,&amp;s\neq 0,\\
    1/2,&amp;s=0.
\end{cases}\]

<p>Note that \(g(s)\) simply defines the continuous extension of \(\psi(s)/s^2\) at \(s=0\). Indeed, \(\lim_{s\to0^+} \psi(s)/s^2=\lim_{s\to0^-}\psi(s)/s^2=1/2\). Note also \(g(s)\) is an increasing function for all \(s\in\Re\). Therefore, for all \(s\leq 0\), \(\psi(s) = s^2 g(s) \leq s^2 g(0) = \frac{s^2}{2}.\)
Since \(Z\leq 0\) and \(\lambda&gt;0\), we may take \(s=\lambda Z\) to obtain \(\phi(\lambda Z) \leq (\lambda Z)^2/2\). Thus,
\(\E[e^{\lambda Z}] - \lambda \E[Z] - 1 \leq \frac{\lambda^2}{2}\E[Z^2],\)
and</p>

\[\begin{align}
\E[\exp(\lambda(Z-\E[Z]))] &amp;\leq e^{-\lambda \E[Z]} ( 1 + \lambda \E[Z] + \lambda^2\E[Z^2]/2) \\
&amp;\leq e^{-\lambda \E[Z]}\exp(\lambda \E[Z] + \lambda^2\E[Z^2]/2) = \exp(\lambda^2\E[Z^2]/2).
\end{align}\]

<p>Replacing \(Z\) with \(-X\) completes the proof.</p>

<h2 id="proof-of-delyon">Proof of Delyon</h2>

<p>Delyon (2009) shows that for all \(x\in \Re\), \(\E[\exp( x - x^2/6)] \leq 1 + x + x^2/3\). Setting \(x = \lambda\Xbar\) and applying expectations gives</p>

\[\begin{align}
\E[\exp\{\lambda\Xbar - \lambda^2\Xbar^2/6\}] &amp;\leq 1 + \lambda\E[\Xbar] + \lambda^2\E[\Xbar^2]/3 \\ 
&amp;= 1 + \lambda^2\E[\Xbar^2]/3 \leq \exp\{\E[\lambda^2\Xbar^2]/3\},
\end{align}\]

<p>using that \(1+x\leq e^x\). Rearranging gives the result.</p>

<h2 id="proof-of-fan">Proof of Fan</h2>

<p>See original Fan et al. paper <a rel="nofollow noopener noreferrer" href="https://arxiv.org/pdf/1311.6273.pdf">here</a>. Note that the function</p>

\[f(x) = \frac{\log(1+x) -x}{x^2/2},\]

<p>is non-decreasing for all \(x&gt;-1\). (Continuously extend the function at \(x=0\).) Consider \(x=-\lambda\) and \(y = \lambda X\). Note that \(\lambda X\geq -\lambda &gt;-1\). Therefore \(f(x)\leq f(y)\) which rearranges to read</p>

\[f(-\lambda) \leq f(\lambda X)  = \frac{\log(1 + \lambda X) -\lambda X}{X^2/2},\]

<p>which in turn rearranges to</p>

\[\lambda X + X^2(\log(1-\lambda) + \lambda)\leq \log(1 + \lambda X).\]

<p>Exponentiating and taking expectations gives</p>

\[\E\exp\{\lambda X + X^2(\log(1-\lambda) +\lambda)\}\leq \E[1 + \lambda X] \leq 1,\]

<p>as claimed.</p>

<h2 id="proof-of-catoni">Proof of Catoni</h2>

<p>Let \(\E\vert X\vert^p\leq v&lt;\infty\). By definition of \(\phi_p\),</p>

\[\begin{align}
\E\exp\bigg\{\phi_p(\lambda \Xbar) - \frac{\lambda^pv^p}{p} \bigg\} &amp;\leq \E\bigg(1 + \lambda \Xbar + \frac{\vert\lambda \Xbar\vert^p}{p}\bigg)\exp\bigg(- \frac{\lambda^pv^p}{p}\bigg) \\ 
&amp;= \E\bigg(1 +  \frac{\vert\lambda \Xbar\vert^p}{p}\bigg)\exp\bigg(- \frac{\lambda^pv^p}{p}\bigg)\\
&amp;\leq \exp\bigg(\frac{\lambda^p \E\vert\Xbar\vert^p}{p}\bigg)\exp\bigg(- \frac{\lambda^pv^p}{p}\bigg)\leq 1,
\end{align}\]

<p>as desired.</p>

  <small>
    <a link="back", href="/research_notes/">Back to all notes</a>
  </small>
</article>
 <!-- "> -->
      </main>

      <!-- Footer  -->
      <div class="container" id="footer">
        <hr>
        <div class='container links'>
          <a href="https://github.com/bchugg" rel='nofollow'><img src="/assets/images/github.png"></a>
          <a href="https://www.goodreads.com/user/show/90945992-ben-chugg" rel='nofollow'><img src="/assets/images/goodreads.png"></a>
          <a href="https://twitter.com/BennyChugg" rel='nofollow'><img src="/assets/images/twitter.png"></a>
        </div>
      
        <div class='copyright'>
          <small>&#169; 2024 Ben Chugg</small>
        </div>
      
      </div>
    </div>

  </body>
</html> 
