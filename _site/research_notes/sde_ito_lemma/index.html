<!DOCTYPE html>
<html lang="en-us">

  <head prefix="og: http://ogp.me/ns#; dc: http://purl.org/dc/terms/#">
  
  
  <!-- Canonical link to help search engines -->
  <link rel="canonical" href="http://localhost:4000/research_notes/sde_ito_lemma/" />

  <!-- Basic meta elements -->
  <meta charset="utf-8" />

  <!-- Enable responsiveness on mobile devices -->
  <meta name="viewport" content="width=device-width,initial-scale=1.0,shrink-to-fit=no" />

  <!-- Mathjax Support -->
  <script type="text/javascript" async
    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>

  <title>
    
     Itô Processes and The Fundamental Theorem of Stochastic Calculus
    
  </title>

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v3.9.1" />
<meta property="og:title" content="Itô Processes and The Fundamental Theorem of Stochastic Calculus" />
<meta name="author" content="Ben Chugg" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Part II of the exploration of stochastic calculus and the Itô integral" />
<meta property="og:description" content="Part II of the exploration of stochastic calculus and the Itô integral" />
<link rel="canonical" href="http://localhost:4000/research_notes/sde_ito_lemma/" />
<meta property="og:url" content="http://localhost:4000/research_notes/sde_ito_lemma/" />
<meta property="og:site_name" content="benny" />
<meta property="og:image" content="http://localhost:4000/assets/writing_images/brownian_motion.gif" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-02-07T00:00:00-08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:image" content="http://localhost:4000/assets/writing_images/brownian_motion.gif" />
<meta property="twitter:title" content="Itô Processes and The Fundamental Theorem of Stochastic Calculus" />
<meta name="twitter:site" content="@bennychugg" />
<meta name="twitter:creator" content="@Ben Chugg" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Ben Chugg","url":"https://benchugg.com"},"dateModified":"2022-02-07T00:00:00-08:00","datePublished":"2022-02-07T00:00:00-08:00","description":"Part II of the exploration of stochastic calculus and the Itô integral","headline":"Itô Processes and The Fundamental Theorem of Stochastic Calculus","image":"http://localhost:4000/assets/writing_images/brownian_motion.gif","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/research_notes/sde_ito_lemma/"},"url":"http://localhost:4000/research_notes/sde_ito_lemma/"}</script>
<!-- End Jekyll SEO tag -->


  <!-- Dublin Core metadata for Zotero -->
  <meta property="dc:title" content="Itô Processes and The Fundamental Theorem of Stochastic Calculus" />
  <meta property="dc:creator" content="Ben Chugg" />
  <meta property="dc:identifier" content="http://localhost:4000/research_notes/sde_ito_lemma/" />
  
  <meta property="dc:date" content="2022-02-07 00:00:00 -0800" />
  
  <meta property="dc:source" content="benny" />

  <!-- Open Graph and Twitter metadata -->
  <meta property="og:title" content="Itô Processes and The Fundamental Theorem of Stochastic Calculus" />
  <meta property="og:url" content="http://localhost:4000/research_notes/sde_ito_lemma/" />
  
    <meta property="og:image" content="http://localhost:4000/assets/writing_images/brownian_motion.gif" />
    <meta name="twitter:image" content="http://localhost:4000/assets/writing_images/brownian_motion.gif" />
  
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  <meta name="twitter:card" content="summary">
  <meta name="twitter:domain" value="benchugg.com" />
  <meta name="twitter:title" value="Itô Processes and The Fundamental Theorem of Stochastic Calculus" />
  <meta name="twitter:url" value="http://localhost:4000" />
  
  <!-- Description is dependent on page type  -->
  
    <meta property="og:description" content="Part II of the exploration of stochastic calculus and the Itô integral">
    <meta name="twitter:description" value="Part II of the exploration of stochastic calculus and the Itô integral" />
    <meta property="og:type" content="article" />
  
  

  <!-- CSS link -->
  <link rel="stylesheet" href="/assets/css/style.css" />

  <!-- Icons -->
  <link rel="apple-touch-icon" sizes="167x167" href="/assets/favicon.ico" />
  <link rel="apple-touch-icon-precomposed" sizes="180x180" href="/assets/favicon.ico" />
  <link rel="apple-touch-icon-precomposed" sizes="152x152" href="/assets/favicon.ico">
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/assets/favicon.ico">
  <link rel="apple-touch-icon-precomposed" href="/assets/favicon.ico">
  <link rel="shortcut icon" href="/assets/favicon.ico" />
  <link rel=”apple-touch-icon” sizes="114×114" href="/assets/favicon.ico" />
  <link rel=”apple-touch-icon” sizes="72×72" href="/assets/favicon.ico" />
  <link rel=”apple-touch-icon” href="/assets/favicon.ico" />
  <link rel=”icon” href="/assets/favicon.ico", sizes="32x32"/>

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="http://localhost:4000/atom.xml" />

  
</head>


  <body class="theme-base-">

    <!-- This if statement decides which sidebar to use -->
    
    <!--
  Target for toggling the sidebar `.sidebar-checkbox` is for regular styles, `#sidebar-checkbox` for
  behavior.
-->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<aside class="sidebar" id="sidebar">
  <div class="sidebar-item">
    
  </div> 

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/">Home</a>

    

    
    
      
        
      
    
      
    
      
    
      
    
      
    
      
        
      
    
      
        
      
    
      
        
          <a class="sidebar-nav-item" href="/papers/">Papers</a>
        
      
    
      
        
          <a class="sidebar-nav-item" href="/research_notes/">Research Notes</a>
        
      
    
      
    
      
    
      
        
          <a class="sidebar-nav-item" href="/writing/">Writing</a>
        
      
    

    <a class='sidebar-nav-item' href="http://incrementspodcast.com">Podcast</a>

    <span class='sidebar-nav-item'>Recommendations</span>
    <ul class="dropdown-menu">
      
        
          
        
      
        
      
        
      
        
      
        
      
        
          
            <li><a href="/books/">Books</a></li>
          
        
      
        
          
            <li><a href="/courses/">Courses</a></li>
          
        
      
        
          
        
      
        
          
        
      
        
      
        
      
        
          
        
      
    </ul>

   </nav> 

  <div class="sidebar-links">
    <div class='container'>
      <a href="https://github.com/bchugg" rel='nofollow'><img src="/assets/images/github_white.png"></a>
      <a href="https://www.linkedin.com/in/ben-chugg-3a4616aa/" rel='nofollow'><img src="/assets/images/linkedin_white.png"></a>
      <a href="https://www.goodreads.com/user/show/90945992-ben-chugg" rel='nofollow'><img src="/assets/images/goodreads_white.png"></a>
      <a href="https://twitter.com/BennyChugg" rel='nofollow'><img src="/assets/images/twitter_white.png"></a>
    </div>
  </div>
</aside>

    

    <!--
      Wrap is the content to shift when toggling the sidebar. We wrap the content to avoid any CSS
      collisions with our real content.
    -->
    <div class="wrap">
      <header class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">benny</a>
            
          </h3>
        </div>
      </header>

      <main class="container content" id="main">
        <article class="note">
  <small>
    <a href="/research_notes/">Back to all notes</a>
  </small>
  <hr>
  
  <p class='title'>Itô Processes and The Fundamental Theorem of Stochastic Calculus</p> 
  \[\newcommand{\dif}{\;\text{d}}
\newcommand{\dd}{\text{d}}
\newcommand{\E}{\mathbb{E}}
\newcommand{\Var}{\mathbb{V}}\]

<ul id="markdown-toc">
  <li><a href="#1-itô-processes" id="markdown-toc-1-itô-processes">1. Itô Processes</a>    <ul>
      <li><a href="#11-example-1-brownian-motion-with-drift" id="markdown-toc-11-example-1-brownian-motion-with-drift">1.1 Example 1: Brownian motion with drift</a></li>
      <li><a href="#12-example-2-geometric-brownian-motion-gbm" id="markdown-toc-12-example-2-geometric-brownian-motion-gbm">1.2 Example 2: Geometric Brownian motion (GBM)</a></li>
      <li><a href="#13-integrals-with-respect-to-an-itô-process" id="markdown-toc-13-integrals-with-respect-to-an-itô-process">1.3 Integrals with respect to an Itô Process</a></li>
    </ul>
  </li>
  <li><a href="#2-aside-manipulating-infinitesimals" id="markdown-toc-2-aside-manipulating-infinitesimals">2. Aside: Manipulating Infinitesimals</a></li>
  <li><a href="#3-itôs-lemma" id="markdown-toc-3-itôs-lemma">3. Itô’s Lemma</a>    <ul>
      <li><a href="#31-proof-sketch" id="markdown-toc-31-proof-sketch">3.1 Proof Sketch</a></li>
      <li><a href="#32-sde-form" id="markdown-toc-32-sde-form">3.2 SDE Form</a></li>
      <li><a href="#33-the-fundamental-theorem-of-stochastic-calculus" id="markdown-toc-33-the-fundamental-theorem-of-stochastic-calculus">3.3 The Fundamental Theorem of Stochastic Calculus</a></li>
    </ul>
  </li>
  <li><a href="#4-examples" id="markdown-toc-4-examples">4. Examples</a>    <ul>
      <li><a href="#41-back-to-basics-int_0t-wdif-w" id="markdown-toc-41-back-to-basics-int_0t-wdif-w">4.1 Back to Basics: \(\int_0^t W\dif W\)</a></li>
      <li><a href="#42-stochastic-integration-by-parts" id="markdown-toc-42-stochastic-integration-by-parts">4.2 Stochastic Integration by Parts</a></li>
      <li><a href="#43-geometric-brownian-motion" id="markdown-toc-43-geometric-brownian-motion">4.3 Geometric Brownian Motion</a></li>
    </ul>
  </li>
</ul>

<p>Throughout, let \(W\) be a Wiener process starting at the origin, and let \(X\) be a stochastic process adapted to \(W\)’s filtration. \(I_t=I_t(X)\) is the <a href="/research_notes/intro_ito/">Itô integral</a> of \(X\) w.r.t. to \(W\).</p>

<h1 id="1-itô-processes">1. Itô Processes</h1>
<p>There are at least two motivations for the Itô process. The first comes from the identity</p>

\[\bigg(\int_0^t \dif W\bigg)^2 = W_t^2 = 2\int_0^t W\dif W + t,\]

<p>which we proved <a href="/research_notes/intro_ito/">previously</a>. Notice that \(t\) cannot be the result of any Itô integral, since \(\E[t]=t\neq 0\), whereas the Itô integral is a martingale and hence is zero in expectation. Thus, the family of Itô integrals <em>is not closed under smooth transformations</em>. In this case the transformation is \(x\mapsto x^2\).</p>

<p>The second is simply that, viewed as a stochastic process, the integral \(I_t\) is less interesting – or, at least, contains fewer degrees of freedom – than we might have hoped. We might want processes to capture trends with tendencies to <em>drift</em>.</p>

<p>We can remedy both of these issues at once by introducing the class of stochastic processes \(X_t\) which evolve as follows:</p>

\[\begin{equation}
\label{eq:ito_process_int}
X_T-X_0 = \int_0^T \mu(X_t,t)\dif t + \int_0^T \sigma(X_t,t)\dif W_t. \tag{1}
\end{equation}\]

<p>The rightmost integral is an Itô integral, where \(\sigma(X_t,t)\) is some stochastic process adapted to the brownian motion \(W\). The leftmost integral is just a Lebesgue integral with respect to time, which will give a real number for each \(\omega\) in the sample space \(\Omega\) on which \(X_t\) is defined.</p>

<p>We’re going to re-write this equation in the differential form</p>

\[\begin{equation}
\label{eq:sde}
\dif X_t = \mu(X_t,t)\dif t + \sigma(X_t,t)\dif W_t. \tag{2}
\end{equation}\]

<p>This, in all it’s glory, is what’s referred to as a stochastic differential equation (SDE). It’s important to note that Equation \(\eqref{eq:sde}\) isn’t actually a precise mathematical statement. It’s simply shorthand for Equation \(\eqref{eq:ito_process_int}\). But it’s definitely easier to write, and also has a nicer intuitive interpretation. Namely, a small change \(\Delta\) in \(X_t\) is normally distributed with expectation \(\mu(X_t,t)\Delta\) and variance \(\sigma(X_t,t)^2\Delta\) (hence the choice of notation). People often find it easier to work with the SDE form instead of the integral form, especially because you can basically operate differentials as you would expect (even though it’s informal) and everything works out.</p>

<p>While it may not seem so at first glance, almost all stochastic processes – except those with jumps – are Itô processes.</p>

<h2 id="11-example-1-brownian-motion-with-drift">1.1 Example 1: Brownian motion with drift</h2>

<p>Suppose  \(\mu\) and \(\sigma\) are constants. Then, if \(X_0=0\) (which we will henceforth assume), Equation \(\eqref{eq:ito_process_int}\) reads \(X_t = \mu t + \sigma W_t\), and as an SDE we have</p>

\[\dif X_t = \alpha \dif t + \beta \dif W_t.\]

<p>If \(X\) satisfies this equation, it’s called Brownian motion with drift \(\alpha\) and variance \(\beta^2\). It’s fairly clear why: \(\E[X_t] = \alpha t\) (since \(\E[W_t]=0\)) and</p>

\[\Var[X_t] = \E[X_t^2] - \alpha^2 t^2 = \beta^2 \E[W_t^2] = \beta^2t,\]

<p>due to the quadratic variation of the Wiener process.</p>

<h2 id="12-example-2-geometric-brownian-motion-gbm">1.2 Example 2: Geometric Brownian motion (GBM)</h2>

<p>Suppose \(\mu(X_t,t)=\alpha X_t\) and \(\sigma(X_t,t) = \beta X_t\) for constants \(\alpha\) and \(\beta\). Then,</p>

\[X_t = X_0 + \alpha\int_0^t X_t\dif t  + \beta\int_0^t X_t\dif W_t,\]

<p>or,</p>

\[\dif X_t= \alpha X_t\dif t + \beta X_t\dif W_t.\]

<p>GBM is so important it has its own <a rel="nofollow noopener noreferrer" href="https://en.wikipedia.org/wiki/Geometric_Brownian_motion">wikipedia page</a> (what else could possibly signal value?). It’s often used to model prices in mathematical finance. Itô’s lemma will give us a way to solve it.</p>

<h2 id="13-integrals-with-respect-to-an-itô-process">1.3 Integrals with respect to an Itô Process</h2>

<p>So far we’ve seen stochastic integrals with respect to Brownian motion. But now that we’ve introduced a new class of processes, we should discuss integrals with respect to those.</p>

<p>Let \(X_t\) be an Itô process: \(\dif X = \mu(X,t)\dif t + \sigma(X,t)\dif W\). Let \(Y_t\) be a process adapted to \(X_t\). Then we define the integral of \(Y\) w.r.t \(X\) as</p>

\[\int_0^t Y \dif X = \int_0^t Y \mu \dif s + \int_0^t Y \sigma \dif W,\]

<p>which is what you might expect. As usual, the integral on the left is a Lebesgue integral w.r.t to the time component, and the integral on the right is an Itô integral.</p>

<h1 id="2-aside-manipulating-infinitesimals">2. Aside: Manipulating Infinitesimals</h1>

<p>Even though Equation \(\eqref{eq:sde}\) is informal, it’s intuitive enough that you’ll often see manipulations done to such equations directly, instead of reverting to the integral version. This isn’t completely out of the ordinary, something similar happens when we do change of variables in intro calculus. E.g., if we have \(\int f(u) f'(u) \dif u\), we might let \(v=f(u)\) and \(dv = f'(u)du\) to deal instead with the integral \(\int v \dif v\). The equation \(dv=f'(u)du\) isn’t meaningful in a precise, technical sense, but it’s still useful to get the final result.</p>

<p>In SDE land, there are a few very common - and very useful - infinitesimal equations to keep in mind:</p>

\[(\dd t)^2 = 0,\quad \dd W\dd t = 0,\quad (\dd W)^2 = \dd t.\]

<p>Intuitively, something like \((\dd W)^2 = \dd t\) should hold because of the quadratic variation of Brownian motion. Rigorously, what this statement means is that for well-behaved (namely, bounded and continuous) functions \(\varphi\) acting on \(W\), that</p>

\[\sum_{i=0}^{n-1} \varphi(W_i)(W_{i+1}-W_i)^2 \to \int_0^T \varphi(W)\dif t,\]

<p>where the convergence is \(L^2\). That is, one shows that</p>

\[\E\bigg\{\bigg(\sum_{i=0}^{n-1}\varphi(W_i)(\Delta W_i^2 - \Delta t_i)\bigg)^2\bigg\}\xrightarrow{n\to\infty}0.\]

<p>Similarly for the other identities. This isn’t incredibly hard but it’s not incredibly insightful either, so we’re not giving the proof. <a rel="nofollow noopener noreferrer" href="https://pi.math.cornell.edu/~web6720/Wendy_slides.pdf">Here</a> are some details if you want them.</p>

<h1 id="3-itôs-lemma">3. Itô’s Lemma</h1>

<p>Our first concern with the family of Itô integrals was that they are not closed under the transformation \(x\mapsto x^2\), which motivated the construction of Itô processes. Itô’s lemma gives us a way to evaluate the transformation of Itô processes under sufficiently smooth transformations. To develop more intuition for the behavior of Brownian motion in the limit, it’s worth giving a sketch of the proof before the result is stated.</p>

<h2 id="31-proof-sketch">3.1 Proof Sketch</h2>

<p>Let \(X_t\) be an Itô process. For sufficiently smooth functions \(f(X,t)\) of two variables, Taylor’s Theorem gives</p>

\[\begin{align}
f(X+\Delta X,t+\Delta t) &amp;= f(X,t) + \frac{\partial f}{\partial X}\Delta X+ 
\frac{\partial f}{\partial t}\Delta t + \frac{1}{2}\frac{\partial^2f}{\partial X^2}(\Delta X)^2\tag{3}\label{eq:taylor1} \\
&amp;\quad + \frac{1}{2}\frac{\partial^2f}{\partial t^2}(\Delta t)^2 + 
\frac{\partial^2f}{\partial X\partial t}\Delta X\Delta t + \text{err}, \tag{4}\label{eq:taylor2}
\end{align}\]

<p>where \(f\) is evaluated at \((X,t)\), and the error term is</p>

\[\text{err} = o((\Delta W)^3 + (\Delta t)^3 + (\Delta t)^2\Delta X + (\Delta X)^2 \Delta t).\]

<p>Now, as \(\Delta t\to 0\) and \(\Delta X \to 0\), we have (using our favorite infinitesimal calculus) \((\Delta t)^2 \to (\dd t)^2 = 0\), and</p>

\[\begin{align*}
(\Delta  X)^2 \to (\dd X)^2 &amp;= (\mu\dif t+ \sigma \dif W)^2 \\
&amp;= \mu^2 \dd t^2 + 2 \mu \sigma \dif t\dif W + \sigma^2 \dd W^2 \\
&amp;= \sigma^2 \dif t.
\end{align*}\]

<p>Similarly,</p>

\[\Delta X\Delta t \to \dd X\dif t = \mu \dd t^2 + \sigma\dif W\dif t=0.\]

<p>Therefore, the three terms in line \(\eqref{eq:taylor2}\) disappear in the limit, and only the terms in the top line remain.</p>

<p>Partition the interval \([0,T]\) into \(n+1\) segments as \(t_0,t_1,\dots,t_{n}\). Let \(X_i=X_{t_i}\), \(\Delta X_i= X_{i+1} - X_i\) and \(\Delta t_i = t_{i+1}-t_i\). Now, write \(f(X_t,t) - f(X_0,0)\) as a telescoping sum of small increments, apply Taylor’s theorem to each term, and take the limit as the partition gets finer and finer (thus ignoring the terms which disappear):</p>

\[\begin{align}
f(X_T,T)-f(X_0,0) &amp;= \lim_{n\to\infty}\sum_{i=0}^{n-1} (f(X_{i+1},t_{i+1}) - f(X_i,t_i)) \\
&amp;= \lim_{n\to\infty}\sum_{i=0}^{n-1} \bigg\{\frac{\partial f}{\partial X}\Delta X_i + \frac{\partial f}{\partial t}\Delta t_i + \frac{1}{2}\frac{\partial ^2 f}{\partial X^2}(\Delta X_i)^2\bigg\} \\
&amp;= \lim_{n\to\infty}\sum_{i=0}^{n-1} \frac{\partial f}{\partial X}\Delta X_i + 
\lim_{n\to\infty}\sum_{i=0}^{n-1} \frac{\partial f}{\partial t}\Delta t_i + \lim_{n\to\infty}\frac{1}{2}\sum_{i=0}^{n-1} \frac{\partial^2 f}{\partial X^2}\sigma^2 \Delta t_i. 
\end{align}\]

<p>In the final sum, we replaced \(\Delta X^2\) with \(\sigma ^2 \Delta t\) due to the arguments above. The first sum of the final line is precisely the integral of the Itô process \(X_t\) with integrand \(f_x\). Thus,</p>

\[\begin{align}
\lim_{n\to\infty}\sum_{i=0}^{n-1} \frac{\partial f}{\partial X}\Delta X_i &amp; = \int_0^T \frac{\partial f}{\partial X}\dif X 
= \int_0^T \mu \frac{\partial f}{\partial X} \dif t + \int_0^T \sigma \frac{\partial f}{\partial X} \dif W.
\end{align}\]

<p>Meanwhile, the second and third sum are regular Riemann integrals with integrands \(f_t\) and \(f_x\sigma^2\) respectively. Putting this all together, we get</p>

\[f(X_T,T) = f(X_0,0) + \int_0^T \mu \frac{\partial f}{\partial X} \dd t + \int_0^T \sigma \frac{\partial f}{\partial X} \dd W + \int_0^T \frac{\partial f}{\partial t}\dd t + \frac{1}{2}\int_0^T \sigma^2 \frac{\partial^2 f}{\partial X^2}\dd t,\]

<p>which is called Itô’s lemma. Again, the partial derivatives and the functions \(\mu\) and \(\sigma\) are evaluated at \((X_t,t)\), we’ve just omitted this for brevity. Notice that for this statement to make sense we need that \(f\in C^2(\mathbb{R})\) (\(f\) is twice differentiable). More specifically, we need \(f(x,\cdot)\in C^1(\mathbb{R})\) as a function of \(t\) and \(f(\cdot,t)\in C^2(\mathbb{R})\) as a function of \(x\).</p>

<p>For standard Brownian motion \(W\), which is an Itô process with \(\mu\equiv 0\) and \(\sigma\equiv 1\), Itô’s lemma gives</p>

\[f(W_T,T)=f(W_0,0) + \int_0^T \frac{\partial f}{\partial W} \dif W + \int_0^T \frac{\partial f}{\partial t}\dif t + \frac{1}{2}\int_0^T \frac{\partial^2 f}{\partial W^2}\dif t.\]

<h2 id="32-sde-form">3.2 SDE Form</h2>

<p>Itô’s lemma is more commonly stated as an SDE. In this case, we write</p>

\[\begin{align}
\dd f(X,t) &amp;= \mu(X,t)f_x(X,t)\dif t + \sigma(X,t) f_x(X,t) \dif W_t + f_t(X,t)\dif t \\
&amp;\quad + \frac{1}{2}\sigma^2(X,t)f_{xx}(X,t)\dif t.
\end{align}\]

<p>Observe that we can gather the differential \(\dd t\) and rewrite this as</p>

\[\dd f = \bigg(\mu f_x + f_t + \frac{1}{2}\sigma^2 f_{xx}\bigg)\dif t + \sigma f_x \dif W,\]

<p>which implies that \(f(X_t,t)\) is itself an Itô process. This is good, as it was one of the primary motivators of defining the Itô process in the first place.</p>

<p>In the case of Brownian motion this simplies to</p>

\[\dd f(W,t) = f_x(W,t)\dif W + f_t(X,t) \dif t + \frac{1}{2} f_{xx}(W,t)\dif t.\]

<h2 id="33-the-fundamental-theorem-of-stochastic-calculus">3.3 The Fundamental Theorem of Stochastic Calculus</h2>

<p>Itô’s lemma is often considered the fundamental theorem of stochastic calculus. To see why, suppose that \(f\) is a function of standard brownian motion \(W_t\) only, \(f(W_t)\). Since \(W_t\) is still a function of \(t\), we apply the chain rule and write</p>

\[\frac{df}{dt} = \frac{df}{dW}\dd W_t,\]

<p>which isn’t <em>precisely</em> rigorous, but it’s also not wrong. Since \(\dd W_t \dd t = 0\), the integral in Itô’s lemma with integrand \(\frac{\partial f}{\partial t}\) disappears, and we’re left with</p>

\[f(W_T)-f(W_0) = \int_0^T \frac{d f}{d W}(W_t)\dif W_t + \frac{1}{2}\int_0^T \frac{d^2 f}{d W^2}(W_t)\dif t.\]

<p>Contrast this with the fundamental theorem of (ordinary) calculus, where we don’t have the final term on the right hand side. Indeed, this term only exists in the stochastic case because of the quadratic variation of Brownian motion (\((\dd W)^2 = \dd t\)). The smooth functions dealt with ordinarily have quadratic variation 0.</p>

<p>Equivalently, we can compare the (single variable) differential form</p>

\[\dd f(W_t) = f_x(W_t)\dif W + \frac{1}{2} f_{xx}(W_t)\dif t,\]

<p>with the chain rule from ordinary calculus:</p>

\[\frac{df}{dt}(x(t)) = f'(x)x'(t),\]

<p>or, in differential form,</p>

\[\dif f(x(t)) = f'(x)\dd x.\]

<p>Again, we see the difference is the non-zero quadratic variation of \(W\).</p>

<h1 id="4-examples">4. Examples</h1>

<p>Often we’re less interested in evaluating \(f(X_t,t)\), but rather in evaluating some stochastic integral \(\int Y_t\dif X_t\). If we can choose a function \(f\) such that one of its partial derivatives equals \(Y_t\), then we’re in business.</p>

<h2 id="41-back-to-basics-int_0t-wdif-w">4.1 Back to Basics: \(\int_0^t W\dif W\)</h2>

<p>We can solve the integral \(\int W\dif W\) much more easily with Itô’s lemma. Consider \(f(W,t)=W^2\). The lemma gives</p>

\[W_t^2 = 2\int_0^t W\dif W + t,\]

<p>which was obtained with much less hassle than before.</p>

<h2 id="42-stochastic-integration-by-parts">4.2 Stochastic Integration by Parts</h2>

<p>Suppose \(g:\mathbb{R}\to\mathbb{R}\) is a deterministic function of time. We’d like to say something about \(\int g(t) \dif W_t\). To do this, we want a smooth function \(f\) which, using Itô’s lemma, yields this integral. Since the lemma involves the derivatives of \(f\), choosing \(f(x,t) = xg(t)\) works nicely. Then \(f_x(x,t) = g(t)\), \(f_{xx}(x,t)=0\) and \(f_t(x,t) = g(t)x'(t) + g'(t)x(t)\). Our favorite lemma gives:</p>

\[\begin{align}
 W_Tg(T) &amp;= \int_0^T g(t)\dif W_t + \int_0^T (W_tf'(t) + f(t)\dif W_t)\dif t \\ 
 &amp;= \int_0^T g(t)\dif W_t + \int_0^T W_tf'(t)\dif t,
\end{align}\]

<p>since \(\dd W_t\dd t=0\). Rearranging and using the intuition that \(f'(t)\dif t = \dd f\) (which can be shown rigorously), we get</p>

\[\int_0^T g(t) \dif W_t = W_Tg(T) - \int_0^T W_t\dd f(t).\]

<p>This looks a lot like the usual integration by parts formula. The rightmost integral should be interpreted as a Riemann-Stieltjes integral.</p>

<h2 id="43-geometric-brownian-motion">4.3 Geometric Brownian Motion</h2>

<p>Recall that GBM satisfies</p>

\[\dd S_t = \mu S_t\dif t + \sigma S_t \dif W_t,\]

<p>for constants \(\mu\) and \(\sigma\). To solve this, we borrow some intuition from ODE theory and guess that logarithms will be involved. In particular, apply Itô’s lemma with \(f(x,t) = f(x) = \log x\). As we saw above, since \(S_t\) is also a function of \(t\), the chain rule applies and \(f_t(S_t) = (S_t)^{-1} \dif S_t\). Thus, Itô’s lemma gives</p>

\[\begin{align}
\dif \log(S_t) &amp;= \bigg(\frac{\dd S_t}{S_t} + \mu S_t \frac{df}{dS} + \sigma^2\frac{S_t^2}{2}\frac{d^2f}{dS^2}\bigg)\dif t + \sigma S_t \frac{df}{dS} \dif W_t \\
&amp;= \frac{d S_t}{S_t}\dif t + \mu\dif t - \frac{\sigma^2}{2}\dif t + \sigma \dif W_t\\
&amp;= \bigg(\mu - \frac{1}{2}\sigma^2\bigg)\dif t + \sigma\dif W_t.
\end{align}\]

<p>Retreating from SDE notation, this means</p>

\[\begin{align}
\log(S_T) - \log(S_0) &amp;= \int_0^T \bigg(\mu - \frac{1}{2}\sigma^2\bigg) \dif t + \int_0^T \sigma \dif W_t  = \bigg(\mu-\frac{1}{2}\sigma^2\bigg) T + \sigma W_T.
\end{align}\]

<p>Exponentiating and performing the relevant arithmetic yields</p>

\[S_T = S_0\exp\bigg(\mu T - \frac{T\sigma^2}{2}\bigg)\exp(\sigma W_T),\]

<p>which gives us a closed form solution for GBM.</p>


  <small>
    <a href="/research_notes/">Back to all notes</a>
  </small>
</article>
 <!-- "> -->
      </main>

      <!-- Footer  -->
      <div class="container" id="footer">
        <hr>
        <div class='container links'>
          <a href="https://github.com/bchugg" rel='nofollow'><img src="/assets/images/github.png"></a>
          <a href="https://www.linkedin.com/in/ben-chugg-3a4616aa/" rel='nofollow'><img src="/assets/images/linkedin.png"></a>
          <a href="https://www.goodreads.com/user/show/90945992-ben-chugg" rel='nofollow'><img src="/assets/images/goodreads.png"></a>
          <a href="https://twitter.com/BennyChugg" rel='nofollow'><img src="/assets/images/twitter.png"></a>
        </div>
      
        <div class='copyright'>
          <small>&#169; 2022 Ben Chugg</small>
        </div>
      
      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script>

    // Highlight search Query
    var url = window.location.href;
      if (url.lastIndexOf("?q=") > 0) {
        // get the index of the parameter, add three (to account for length)
        var stringloc = url.lastIndexOf("?q=") + 3;
        // get the substring (query) and decode
        var searchquery = decodeURIComponent(url.substr(stringloc));
        // regex matches at beginning of line, end of line or word boundary, useful for poetry
        var regex = new RegExp("(?:^|\\b)(" + searchquery + ")(?:$|\\b)", "gim");
        // get, add mark and then set content
        var content = document.getElementById("main").innerHTML;
        document.getElementById("main").innerHTML = content.replace(regex, "<mark>$1</mark>");
      }

      // Toggle sidebar
      (function(document) {
        var toggle = document.querySelector('.sidebar-toggle');
        var sidebar = document.querySelector('#sidebar');
        var checkbox = document.querySelector('#sidebar-checkbox');

        document.addEventListener('click', function(e) {
          var target = e.target;

          if(!checkbox.checked ||
             !sidebar.contains(target) ||
             (target === checkbox || target === toggle)) return;

          checkbox.checked = false;
        }, false);
      })(document);
    </script>

<!-- Facebook SDK for JavaScript -->
<script>
  window.fbAsyncInit = function() {
    FB.init({
      appId      : '589495744558280',
      xfbml      : true,
      version    : 'v2.6'
    });
  };

  (function(d, s, id){
     var js, fjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement(s); js.id = id;
     js.src = "//connect.facebook.net/en_US/sdk.js";
     fjs.parentNode.insertBefore(js, fjs);
   }(document, 'script', 'facebook-jssdk'));
</script>
  </body>
</html>
