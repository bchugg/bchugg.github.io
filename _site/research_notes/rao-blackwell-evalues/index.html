<!DOCTYPE html>
<html lang="en-us">

  <head prefix="og: http://ogp.me/ns#; dc: http://purl.org/dc/terms/#">
  
  
  <!-- Canonical link to help search engines -->
  <link rel="canonical" href="http://localhost:4000/research_notes/rao-blackwell-evalues/" />

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PN2H9928PZ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-PN2H9928PZ');
  </script>

  <!-- Open external links in new tab -->
  <script>
  document.addEventListener('DOMContentLoaded', () => {
    document.querySelectorAll('a[href]').forEach(a => {
      const href = a.getAttribute('href');
      if (!href) return;

      // ignore in-page, mail, phone, js
      if (href.startsWith('#') || href.startsWith('mailto:') || href.startsWith('tel:') || href.startsWith('javascript:')) return;

      const url = new URL(href, window.location.href);

      // only external
      if (url.origin !== window.location.origin) {
        a.target = '_blank';
        a.rel = 'nofollow noopener noreferrer';
      }
    });
  });
  </script>

  <!-- Basic meta elements -->
  <meta charset="utf-8" />

  <!-- Enable responsiveness on mobile devices -->
  <meta name="viewport" content="width=device-width,initial-scale=1.0,shrink-to-fit=no" />

  <!-- Mathjax Support -->
  <script type="text/javascript" async
    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>

  <title>
    
     Rao-Blackwellization for e-values
    
  </title>

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v3.9.1" />
<meta property="og:title" content="Rao-Blackwellization for e-values" />
<meta name="author" content="Ben Chugg" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Making e-values more powerful by conditioning on a sufficient statistic" />
<meta property="og:description" content="Making e-values more powerful by conditioning on a sufficient statistic" />
<link rel="canonical" href="http://localhost:4000/research_notes/rao-blackwell-evalues/" />
<meta property="og:url" content="http://localhost:4000/research_notes/rao-blackwell-evalues/" />
<meta property="og:site_name" content="benny" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-08-22T00:00:00-07:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Rao-Blackwellization for e-values" />
<meta name="twitter:site" content="@bennychugg" />
<meta name="twitter:creator" content="@Ben Chugg" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Ben Chugg","url":"https://benchugg.com"},"dateModified":"2025-08-22T00:00:00-07:00","datePublished":"2025-08-22T00:00:00-07:00","description":"Making e-values more powerful by conditioning on a sufficient statistic","headline":"Rao-Blackwellization for e-values","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/research_notes/rao-blackwell-evalues/"},"url":"http://localhost:4000/research_notes/rao-blackwell-evalues/"}</script>
<!-- End Jekyll SEO tag -->


  <!-- Dublin Core metadata for Zotero -->
  <meta property="dc:title" content="Rao-Blackwellization for e-values" />
  <meta property="dc:creator" content="Ben Chugg" />
  <meta property="dc:identifier" content="http://localhost:4000/research_notes/rao-blackwell-evalues/" />
  
  <meta property="dc:date" content="2025-08-22 00:00:00 -0700" />
  
  <meta property="dc:source" content="benny" />

  <!-- Open Graph and Twitter metadata -->
  <meta property="og:title" content="Rao-Blackwellization for e-values" />
  <meta property="og:url" content="http://localhost:4000/research_notes/rao-blackwell-evalues/" />
  
    <meta property="og:image" content="http://localhost:4000/assets/images/heads.jpeg"/>
    <meta name="twitter:image" content="http://localhost:4000/assets/images/heads.jpeg" />
  
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:domain" value="benchugg.com" />
  <meta name="twitter:title" value="Rao-Blackwellization for e-values" />
  <meta name="twitter:url" value="http://localhost:4000" />
  
  <!-- Description is dependent on page type  -->
  
    <meta property="og:description" content="Making e-values more powerful by conditioning on a sufficient statistic">
    <meta name="twitter:description" value="Making e-values more powerful by conditioning on a sufficient statistic" />
    <meta property="og:type" content="article" />
  
  

  <!-- CSS link -->
  <link rel="stylesheet" href="/assets/css/style.css" />

  <!-- Icons -->
  <link rel="apple-touch-icon" sizes="167x167" href="/assets/favicon.ico" />
  <link rel="apple-touch-icon-precomposed" sizes="180x180" href="/assets/favicon.ico" />
  <link rel="apple-touch-icon-precomposed" sizes="152x152" href="/assets/favicon.ico">
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/assets/favicon.ico">
  <link rel="apple-touch-icon-precomposed" href="/assets/favicon.ico">
  <link rel="shortcut icon" href="/assets/favicon.ico" />
  <link rel=”apple-touch-icon” sizes="114×114" href="/assets/favicon.ico" />
  <link rel=”apple-touch-icon” sizes="72×72" href="/assets/favicon.ico" />
  <link rel=”apple-touch-icon” href="/assets/favicon.ico" />
  <link rel=”icon” href="/assets/favicon.ico", sizes="32x32"/>

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="http://localhost:4000/atom.xml" />

  
</head>


  <body class="theme-base-">


    <!--
      Wrap is the content to shift when toggling the sidebar. We wrap the content to avoid any CSS
      collisions with our real content.
    -->
    <div class="wrap">
      <header class="masthead">
        <div class="container">
          <a id='name' href="/">Ben Chugg</a>
          <div class="span">
            <a href="/papers/">Papers</a> 
            <a href="/writing/">Writing</a>
            <a href="/research_notes/">Notes</a>
          </div>
        </div>
      </header>

      <main class="container content" id="main">
        <article class="note">
  <!-- <small>
    <a id="back", href="/research_notes/">Back to all notes</a>
  </small> -->
  <!-- <hr> -->
  
  <p class='title'>Rao-Blackwellization for e-values</p> 
  <p id="date">August 22, 2025</p>
  <br/>
  \[\newcommand{\E}{\mathbb{E}}
\newcommand{\calF}{\mathcal{F}}\]

<p>The <a href="https://thestatsmap.com/Rao-Blackwell-theorem">Rao-Blackwell theorem</a> is a famous result in statistical decision theory which says that the mean squared error (or more generally, any convex loss) of an estimator can never be made worse by conditioning on a sufficient statistic. While the theory doesn’t say that the estimator will certainly get better, the gains in practice are often significant. (See this <a href="https://en.wikipedia.org/wiki/Rao%E2%80%93Blackwell_theorem#Example">nice example from wikipedia</a>.)</p>

<p>It turns out that there is a similar result in the world of <a href="https://thestatsmap.com/e-value">e-values</a>, which I realized recently while writing a <a href="https://arxiv.org/pdf/2508.00770">paper on post-hoc hypothesis testing</a>. I only wrote down the result for testing point hypotheses (see Theorem 4.10 in there), but it holds more generally. The proof is exceedingly simple and the statement is very general.</p>

<p>Suppose we are testing the null \(\theta\in\Theta_0\) against the alternative \(\theta\in\Theta_1\), and suppose there is a sufficient statistic \(T\) for the parameter \(\theta\). (This probably means we’re in a parametric setting.)</p>

<p>Let \(E\) be an e-variable for \(\Theta_0\) (i.e., \(E\geq 0\) and \(\sup_{\theta\in\Theta_0}\E_\theta [E]\leq 1\)) and define</p>

\[S_T = \E_{\theta^*}[E \vert T],\]

<p>for any fixed \(\theta^*\in\Theta\).</p>

<p>By definition of sufficiency, \(S_T\) is independent of \(\theta^*\), so \(\E_\theta [E\vert T] = \E_\phi[E\vert T]=S_T\) for any \(\theta, \phi\). This implies that \(S_T\) is a bonafide e-variable:</p>

\[\sup_{\theta\in\Theta_0} \E_\theta[S_T] = \sup_{\theta\in\Theta_0} \E_\theta[\E_\theta[E|T]] = \sup_{\theta\in\Theta_0}\E_\theta[E]\leq 1.\]

<p>As in the usual Rao-Blackwell setting, it’s important to emphasize that \(S_T\) is <em>observable</em> (i.e., computable). This is because, as we said, it does not depend on \(\theta\) by definition of a sufficient statistic.</p>

<p>Next, we claim that \(\E_\phi[f(S_T)] \geq \E_\phi [f(E)]\) for any concave function \(f\) and any \(\phi\in\Theta_1\). For any \(\theta\in\Theta_0\), by concavity,</p>

\[\begin{align}
    \E_\theta[f(E)|T] \leq f(\E_\theta[E|T]) = f(S_T). 
\end{align}\]

<p>Now, the likelihood ratio \(\Lambda_{\phi, \theta} = d P_\phi/dP_\theta\) is <em>minimally</em> sufficient so it is \(T\)-measurable (apply the Fisher-Neyman characterization to write \(\Lambda_{\phi,\theta}\) as a function of \(T\)). Therefore,</p>

\[\begin{align}
    \E_\phi[f(S_T)] &amp;= \E_\theta[\Lambda f(S_T)] \geq \E_\theta[\Lambda \E_\theta[f(E)|T]] \\
    &amp;= \E_\theta[\E_P[\Lambda  f(E)|T]] = \E_\theta[\Lambda f(E)] = \E_\phi[f(E)], \label{eq:Ef&gt;Ef}
\end{align}\]

<p>proving the claim. An important special case is when \(f=\log\), in which case we obtain that</p>

\[\E_\phi [\log(S_T)]\geq \E_\phi [\log(E)].\]

<p>Log-power under the alternative is the usual criteria by which we judge e-values, and this result shows that log-power will never get worse if we condition on a sufficient statistic.</p>

<p>This result can be easily extended to <a href="https://thestatsmap.com/e-process">e-processes</a>. If \((E_t)\) is an e-process adapted to a filtration \(\calF = (\calF_t)\) and \((T_t)\) is a sequence of sufficient statistics also adapted to \(\calF\) (e.g., \(T_t = \sum_{i\leq t}X_i\) for a binomial or Poisson process), then</p>

\[S_t = \E_{\theta^*}[E_t | T_t],\]

<p>is also an e-process. And, as above, \(\E_\phi [f (S_t)] \geq E_\phi [f(E_t)]\) for any concave function \(f\), so \((S_t)\) has at least as good a growth rate as \(E_t\) under the alternative.</p>


  <small>
    <a link="back", href="/research_notes/">Back to all notes</a>
  </small>
</article>

      </main>

      <!-- Footer  -->
      <div class="container" id="footer">
        <hr>
        <div class='container links'>
          <a href="https://github.com/bchugg" rel='nofollow'><img src="/assets/images/github.png"></a>
          <a href="https://www.goodreads.com/user/show/90945992-ben-chugg" rel='nofollow'><img src="/assets/images/goodreads.png"></a>
          <a href="https://twitter.com/BennyChugg" rel='nofollow'><img src="/assets/images/twitter.png"></a>
          <a href="https://www.stepstophaeacia.com/" rel='nofollow'><img src="/assets/images/substack.jpeg"></a>
        </div>
      
        <div class='copyright'>
          <small>&#169; 2025 Ben Chugg</small>
        </div>
      
      </div>
    </div>

  </body>
</html> 
