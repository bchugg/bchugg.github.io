<!DOCTYPE html>
<html lang="en-us">

  <head prefix="og: http://ogp.me/ns#; dc: http://purl.org/dc/terms/#">
  
  
  <!-- Canonical link to help search engines -->
  <link rel="canonical" href="http://localhost:4000/drafts/variational_vs_mom/" />

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PN2H9928PZ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-PN2H9928PZ');
  </script>

  <!-- Basic meta elements -->
  <meta charset="utf-8" />

  <!-- Enable responsiveness on mobile devices -->
  <meta name="viewport" content="width=device-width,initial-scale=1.0,shrink-to-fit=no" />

  <!-- Mathjax Support -->
  <script type="text/javascript" async
    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>

  <title>
    
     The variational technique generalizes the method of mixtures
    
  </title>

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v3.9.1" />
<meta property="og:title" content="The variational technique generalizes the method of mixtures" />
<meta name="author" content="Ben Chugg" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="A convenient way to think about the variational approach to concentration" />
<meta property="og:description" content="A convenient way to think about the variational approach to concentration" />
<link rel="canonical" href="http://localhost:4000/drafts/variational_vs_mom/" />
<meta property="og:url" content="http://localhost:4000/drafts/variational_vs_mom/" />
<meta property="og:site_name" content="benny" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-08-09T00:00:00-04:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="The variational technique generalizes the method of mixtures" />
<meta name="twitter:site" content="@bennychugg" />
<meta name="twitter:creator" content="@Ben Chugg" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Ben Chugg","url":"https://benchugg.com"},"dateModified":"2025-08-09T00:00:00-04:00","datePublished":"2025-08-09T00:00:00-04:00","description":"A convenient way to think about the variational approach to concentration","headline":"The variational technique generalizes the method of mixtures","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/drafts/variational_vs_mom/"},"url":"http://localhost:4000/drafts/variational_vs_mom/"}</script>
<!-- End Jekyll SEO tag -->


  <!-- Dublin Core metadata for Zotero -->
  <meta property="dc:title" content="The variational technique generalizes the method of mixtures" />
  <meta property="dc:creator" content="Ben Chugg" />
  <meta property="dc:identifier" content="http://localhost:4000/drafts/variational_vs_mom/" />
  
  <meta property="dc:date" content="2025-08-09" />
  
  <meta property="dc:source" content="benny" />

  <!-- Open Graph and Twitter metadata -->
  <meta property="og:title" content="The variational technique generalizes the method of mixtures" />
  <meta property="og:url" content="http://localhost:4000/drafts/variational_vs_mom/" />
  
    <meta property="og:image" content="http://localhost:4000/assets/images/heads.jpeg"/>
    <meta name="twitter:image" content="http://localhost:4000/assets/images/heads.jpeg" />
  
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:domain" value="benchugg.com" />
  <meta name="twitter:title" value="The variational technique generalizes the method of mixtures" />
  <meta name="twitter:url" value="http://localhost:4000" />
  
  <!-- Description is dependent on page type  -->
  
    <meta property="og:description" content="A convenient way to think about the variational approach to concentration">
    <meta name="twitter:description" value="A convenient way to think about the variational approach to concentration" />
    <meta property="og:type" content="article" />
  
  

  <!-- CSS link -->
  <link rel="stylesheet" href="/assets/css/style.css" />

  <!-- Icons -->
  <link rel="apple-touch-icon" sizes="167x167" href="/assets/favicon.ico" />
  <link rel="apple-touch-icon-precomposed" sizes="180x180" href="/assets/favicon.ico" />
  <link rel="apple-touch-icon-precomposed" sizes="152x152" href="/assets/favicon.ico">
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/assets/favicon.ico">
  <link rel="apple-touch-icon-precomposed" href="/assets/favicon.ico">
  <link rel="shortcut icon" href="/assets/favicon.ico" />
  <link rel=”apple-touch-icon” sizes="114×114" href="/assets/favicon.ico" />
  <link rel=”apple-touch-icon” sizes="72×72" href="/assets/favicon.ico" />
  <link rel=”apple-touch-icon” href="/assets/favicon.ico" />
  <link rel=”icon” href="/assets/favicon.ico", sizes="32x32"/>

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="http://localhost:4000/atom.xml" />

  
</head>


  <body class="theme-base-">


    <!--
      Wrap is the content to shift when toggling the sidebar. We wrap the content to avoid any CSS
      collisions with our real content.
    -->
    <div class="wrap">
      <header class="masthead">
        <div class="container">
          <a id='name' href="/">Ben Chugg</a>
          <div class="span">
            <a href="/papers/">Papers</a> 
            <a href="/writing/">Writing</a>
            <a href="/research_notes/">Notes</a>
          </div>
        </div>
      </header>

      <main class="container content" id="main">
        <article class="note">
  <!-- <small>
    <a id="back", href="/research_notes/">Back to all notes</a>
  </small> -->
  <!-- <hr> -->
  
  <p class='title'>The variational technique generalizes the method of mixtures</p> 
  <p id="date">August 09, 2025</p>
  <br/>
  \[\renewcommand{\Re}{\mathbb{R}}
\newcommand{\dsphere}{\mathbb{S}^{d-1}}
\newcommand{\E}{\mathbb{E}}
\newcommand{\la}{\langle}
\newcommand{\ra}{\rangle}
\newcommand{\d}{\text{d}}
\newcommand{\kl}{\text{D}_{\text{KL}}}\]

<p>The last two posts explored two different ways to prove the classical self-normalized concentration inequality for sub-Gaussian processes. The original method used by de la Pena (and later Abbasi-Yadkori et al.) used the method mixtures. But we saw that one can also use the variational approach to concentration to prove the same thing.</p>

<p>This had me thinking about the relationship between the variational technique and the method of mixtures. While I still don’t have a total grasp of their relationship, here’s a painfully obvious observation in hindsight: the variational technique can be seen as a generalization of the method of mixtures.</p>

<p>Suppose we have some random vector \(X\) in \(\Re^d\) with law \(P\). We want to bound \(\|X\|_2\) with high probability (we can consider more general norms—including obviously matrix norms since that’s what we did before—but let’s keep it simple for now).  Both the variational approach and the method of mixtures tell us to find some e-value \(E(\theta)\) for each \(\theta\in\Theta\) which is a function of \(\la \theta, X\ra\). Here \(\Theta\) is some parameter space, often the unit-sphere, the unit-ball, or all of \(\Re^d\).</p>

<p>Such an e-value typically has the following form:</p>

\[E(\theta) = \exp\{\la \theta, X\ra - \psi(\lambda)\la \theta, V\theta\ra\},\]

<p>for some PSD matrix \(V\) and some real-valued function \(\psi\). (In the sequential setting this would be a sub-\(\psi\) process.)</p>

<p>In the method of mixtures we pick some data-free distribution \(\nu\) over \(\Theta\) and consider the random variable</p>

\[E^{\nu} := \int E(\theta) \d\nu(\theta).\]

<p>By Fubini’s theorem, \(E^\nu\) is also an e-value:</p>

\[\begin{equation}
\label{eq:switch}
\E_P \int E(\theta)\d\nu  = \int \E_P E(\theta)\d\nu \leq 1,\tag{1}
\end{equation}\]

<p>where we can exchange the two integrals since \(\nu\) is independent of the data. Therefore, by Markov, \(P(E^\nu &gt; 1/\delta) \leq \delta\). That is, with probability \(1-\delta\), \(\log(E^\nu) \leq \log(1/\delta)\). By Jensen’s inequality,</p>

\[\int\log E(\theta)\d\nu \leq \log \int E(\theta) \d\nu \leq \log(1/\delta),\]

<p>and</p>

\[\int\log E(\theta)  \d\nu = \int \la \theta, S\ra\d\nu - \psi(\lambda) \la \theta, V\theta\ra\d\nu \leq \log(1/\delta).\]

<p>In the variational approach, we pick some data-<em>dependent</em> distribution \(\rho\) and we consider</p>

\[E^\rho := \int E(\theta) \d\rho.\]

<p>This time, we cannot conclude that \(E^\rho\) is an e-variable since we cannot exchange the integrals as we did in \eqref{eq:switch}.  Instead, we rely on the Donsker-Varadhan formula, which states that for a measurable function \(f:\Theta\to\Re\) and a data-free distribution \(\nu\) as above,</p>

\[\log \E_\nu \exp(f(\theta)) \geq \E_\rho f(\theta) - \kl(\rho\|\nu),\]

<p>where \(\kl(\rho\|\nu)\) is the KL-divergence between \(\rho\) and \(\nu\). Consider \(f(\theta) = \log E(\theta)\), which is well-defined since \(E(\theta)\) is nonnegative (and we’ll assume it’s not identically zero for convenience). Then the Donsker-Varadhan formula gives</p>

\[\int \log E(\theta) \d\rho \leq \kl(\rho\|\nu) + \log \int E(\theta) \d\nu.\]

<p>And with probability \(1-\delta\), using the previous bound on \(\log\int E(\theta)\d\nu\) we have</p>

\[\int \log E(\theta) \d\rho \leq \kl(\rho\|\nu) + \log(1/\delta).\]

<p>This is a generalization of the method of mixtures in the sense that if we pick \(\rho = \nu\), then the KL divergence disappears and we recover the MoM bound.</p>

<p>So really, the variational approach is just asking the question: What penalty do we have to suffer if we want to use a data-dependent mixing distribution in the method of mixtures? And the answer is a KL divergence (or, more generally, some \(f\)-divergence).</p>


  <small>
    <a link="back", href="/research_notes/">Back to all notes</a>
  </small>
</article>
 <!-- "> -->
      </main>

      <!-- Footer  -->
      <div class="container" id="footer">
        <hr>
        <div class='container links'>
          <a href="https://github.com/bchugg" rel='nofollow'><img src="/assets/images/github.png"></a>
          <a href="https://www.goodreads.com/user/show/90945992-ben-chugg" rel='nofollow'><img src="/assets/images/goodreads.png"></a>
          <a href="https://twitter.com/BennyChugg" rel='nofollow'><img src="/assets/images/twitter.png"></a>
          <a href="https://www.stepstophaeacia.com/" rel='nofollow'><img src="/assets/images/substack.jpeg"></a>
        </div>
      
        <div class='copyright'>
          <small>&#169; 2025 Ben Chugg</small>
        </div>
      
      </div>
    </div>

  </body>
</html> 
